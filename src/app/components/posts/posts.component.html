<div class="entire-post" [@singlePost] (clickOutside)="onClickedOutside()">
  <div class="single-post" [ngClass]="{ blueTag: index % 2 === 1 }">
    <div class="post-content" (clickOutside)="onClickedOutsideContent()">
      <svg
        class="manage-post"
        *ngIf="loggedUser.id === 2 || loggedUser.id === post.authorID"
        (click)="seeDropDownPost()"
        version="1.1"
        id="Capa_1"
        xmlns="http://www.w3.org/2000/svg"
        xmlns:xlink="http://www.w3.org/1999/xlink"
        x="0px"
        y="0px"
        viewBox="0 0 58 58"
        style="enable-background:new 0 0 58 58;"
        xml:space="preserve"
      >
        <circle style="fill:#9faec0;" cx="7" cy="29" r="7" />
        <circle style="fill:#9faec0;" cx="51" cy="29" r="7" />
        <circle style="fill:#9faec0;" cx="29" cy="29" r="7" />
        <circle style="fill:#9faec0;" cx="7" cy="29" r="7" />
        <circle style="fill:#9faec0;" cx="51" cy="29" r="7" />
        <circle style="fill:#9faec0;" cx="29" cy="29" r="7" />
        <g></g>
        <g></g>
        <g></g>
        <g></g>
        <g></g>
        <g></g>
        <g></g>
        <g></g>
        <g></g>
        <g></g>
        <g></g>
        <g></g>
        <g></g>
        <g></g>
        <g></g>
      </svg>

      <div
        class="dropdown-post"
        *ngIf="dropDownPostOpen"
        [@onManage]
        [ngClass]="{ moveDown: post.wasEdited === true }"
      >
        <div>
          <svg
            class="svg-edit-post"
            [ngClass]="{ svgActive: postEditable }"
            (click)="onEditPost()"
            height="381pt"
            viewBox="0 -1 381.53417 381"
            width="381pt"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              style="fill: #1b3d5d"
              d="m370.589844 230.964844c-5.523438 0-10 4.476562-10 10v88.792968c-.019532 16.558594-13.4375 29.980469-30 30h-280.589844c-16.5625-.019531-29.980469-13.441406-30-30v-260.589843c.019531-16.5625 13.4375-29.980469 30-30h88.789062c5.523438 0 10-4.476563 10-10 0-5.523438-4.476562-10-10-10h-88.789062c-27.601562.03125-49.96875 22.398437-50 50v260.589843c.03125 27.601563 22.398438 49.96875 50 50h280.589844c27.601562-.03125 49.96875-22.398437 50-50v-88.789062c0-5.523438-4.476563-10.003906-10-10.003906zm0 0"
            />
            <path
              style="fill: #1b3d5d"
              d="m156.367188 178.34375 146.011718-146.015625 47.089844 47.089844-146.011719 146.015625zm0 0"
            />
            <path
              style="fill: #1b3d5d"
              d="m132.542969 249.257812 52.039062-14.414062-37.625-37.625zm0 0"
            />
            <path
              style="fill: #1b3d5d"
              d="m362.488281 7.578125c-9.769531-9.746094-25.585937-9.746094-35.355469 0l-10.605468 10.605469 47.089844 47.089844 10.605468-10.605469c9.75-9.769531 9.75-25.585938 0-35.355469zm0 0"
            />
          </svg>
        </div>
        <div>
          <svg
            (click)="deletePost()"
            height="427pt"
            viewBox="-40 0 427 427.00131"
            width="427pt"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              style="fill: #1b3d5d"
              d="m232.398438 154.703125c-5.523438 0-10 4.476563-10 10v189c0 5.519531 4.476562 10 10 10 5.523437 0 10-4.480469 10-10v-189c0-5.523437-4.476563-10-10-10zm0 0"
            />
            <path
              style="fill: #1b3d5d"
              d="m114.398438 154.703125c-5.523438 0-10 4.476563-10 10v189c0 5.519531 4.476562 10 10 10 5.523437 0 10-4.480469 10-10v-189c0-5.523437-4.476563-10-10-10zm0 0"
            />
            <path
              style="fill: #1b3d5d"
              d="m28.398438 127.121094v246.378906c0 14.5625 5.339843 28.238281 14.667968 38.050781 9.285156 9.839844 22.207032 15.425781 35.730469 15.449219h189.203125c13.527344-.023438 26.449219-5.609375 35.730469-15.449219 9.328125-9.8125 14.667969-23.488281 14.667969-38.050781v-246.378906c18.542968-4.921875 30.558593-22.835938 28.078124-41.863282-2.484374-19.023437-18.691406-33.253906-37.878906-33.257812h-51.199218v-12.5c.058593-10.511719-4.097657-20.605469-11.539063-28.03125-7.441406-7.421875-17.550781-11.5546875-28.0625-11.46875h-88.796875c-10.511719-.0859375-20.621094 4.046875-28.0625 11.46875-7.441406 7.425781-11.597656 17.519531-11.539062 28.03125v12.5h-51.199219c-19.1875.003906-35.394531 14.234375-37.878907 33.257812-2.480468 19.027344 9.535157 36.941407 28.078126 41.863282zm239.601562 279.878906h-189.203125c-17.097656 0-30.398437-14.6875-30.398437-33.5v-245.5h250v245.5c0 18.8125-13.300782 33.5-30.398438 33.5zm-158.601562-367.5c-.066407-5.207031 1.980468-10.21875 5.675781-13.894531 3.691406-3.675781 8.714843-5.695313 13.925781-5.605469h88.796875c5.210937-.089844 10.234375 1.929688 13.925781 5.605469 3.695313 3.671875 5.742188 8.6875 5.675782 13.894531v12.5h-128zm-71.199219 32.5h270.398437c9.941406 0 18 8.058594 18 18s-8.058594 18-18 18h-270.398437c-9.941407 0-18-8.058594-18-18s8.058593-18 18-18zm0 0"
            />
            <path
              style="fill: #1b3d5d"
              d="m173.398438 154.703125c-5.523438 0-10 4.476563-10 10v189c0 5.519531 4.476562 10 10 10 5.523437 0 10-4.480469 10-10v-189c0-5.523437-4.476563-10-10-10zm0 0"
            />
          </svg>
        </div>
      </div>
      <div class="post-header">
        <div class="post-details">
          <div class="picture-container">
            <svg
              class="author-post-img"
              *ngIf="post.authorImgPath === 'unset'"
              xmlns="http://www.w3.org/2000/svg"
              width="20px"
              height="20px"
              viewBox="0 0 24 24"
            >
              <g
                fill="none"
                fill-rule="evenodd"
                stroke="#1b3d5d"
                transform="translate(4 3)"
              >
                <circle cx="7.5" cy="5" r="5"></circle>
                <path d="M15 17.5a7.5 7.5 0 0 0-15 0"></path>
              </g>
            </svg>
            <div
              class="user-set-picture"
              *ngIf="post.authorImgPath != 'unset'"
              #postUserImg
            ></div>
          </div>
          <div class="post-author">
            <div class="author-name">{{ post.author }}</div>
            <div class="author-position">{{ post.position }}</div>
            <div class="author-company">{{ post.company }}</div>
          </div>
        </div>
        <div
          class="post-date"
          [ngClass]="{
            reAlign: loggedUser.id != post.authorID && loggedUser.id != 2
          }"
        >
          {{ post.date | date: "dd MMM, yyyy HH:mm" | lowercase }}
          <div class="edited-post" *ngIf="post.wasEdited === true">
            (edited post)
          </div>
        </div>
      </div>
      <div class="post-message">
        <div class="regular-message" [ngClass]="{ hide: postEditable }">
          <input type="checkbox" class="read-more-state" [id]="post.id" />

          <p class="read-more-wrap" *ngIf="post.message.length >= 750">
            {{ post.message | slice: 0:524
            }}<span class="more-text-dots" *ngIf="!seeMoreText">...</span>
            <span class="read-more-target" *ngIf="seeMoreText"
              >{{ post.message | slice: 524 }}
            </span>
          </p>

          <p
            *ngIf="post.message.length < 750"
            [innerHTML]="post.message | linkify"
          ></p>

          <label
            (click)="seeMoreButton(this)"
            *ngIf="post.message.length >= 750"
            [for]="post.id"
            class="read-more-trigger"
            [ngClass]="{ blueText: index % 2 === 1 }"
          ></label>
        </div>
        <div
          class="editable-message"
          #editPost
          [ngClass]="{ show: postEditable }"
        >
          <textarea
            class="edit-post-textarea"
            type="text"
            [value]="post.message"
            (keyup)="autogrow($event)"
            #newPost
            [ngClass]="{ blueBorder: index % 2 === 1 }"
          ></textarea>
          <div>
            <button
              (click)="changePost($event)"
              [disabled]="newPost.value.length < 1"
            >
              Save
            </button>
            <button
              type="button"
              class="cancelButton"
              (click)="seeDropDownPost()"
            >
              Cancel
            </button>
          </div>
        </div>
      </div>
    </div>
    <div class="likes-and-comments">
      <div class="likes" (click)="onLikePost()">
        <div class="likes-amount">
          {{ post.likes.length }}
        </div>

        <div class="like-svg">
          <svg
            version="1.1"
            id="Capa_1"
            xmlns="http:www.w3.org/2000/svg"
            xmlns:xlink="http://www.w3.org/1999/xlink"
            x="0px"
            y="0px"
            viewBox="0 0 50.747 50.747"
            style="enable-background:new 0 0 50.747 50.747;"
            xml:space="preserve"
          >
            <g>
              <g>
                <path
                  class="like-svg-path"
                  #likeButton
                  style="fill:white;"
                  d="M48.837,25.537l-3.146-6.834c0,0-7.188,0.333-8.535-1.667c-1.348-2,1.648-7.833-0.898-13.333
                   c-1.865-4.031-4.697-3.496-6.076-2.923c-0.465,0.193-0.672,0.844-0.539,1.376c0.907,3.671,1.322,11.022-3.867,14.214
                   c-1.665,1.024-2.65,2.391-5.751,2.939c-0.465,0.083-2.735,2.146-3.212,2.188c-3.876,0.337-7.521,0.322-10.07,0.238
                   C6.905,22.138,7,22.576,7,23.037v23c0,0.422-0.087,0.82-0.224,1.195c9.794-0.037,12.711,1.218,12.711,1.218
                   c16.772,4.246,23.51,0.087,23.51,0.087s3.594-9,6.589-14S48.837,25.537,48.837,25.537z"
                />
                <path
                  class="like-svg-path"
                  #likeButton
                  style="fill:white;"
                  d="M3.5,20.537h-1c-1.378,0-2.5,1.122-2.5,2.5v23c0,1.379,1.122,2.5,2.5,2.5h1
                   c1.378,0,2.5-1.121,2.5-2.5v-23C6,21.659,4.878,20.537,3.5,20.537z"
                />
              </g>
            </g>
            <g></g>
            <g></g>
            <g></g>
            <g></g>
            <g></g>
            <g></g>
            <g></g>
            <g></g>
            <g></g>
            <g></g>
            <g></g>
            <g></g>
            <g></g>
            <g></g>
            <g></g>
          </svg>
        </div>
      </div>
      <div class="comments" (click)="onSeeComments()">
        <div class="comments-amount">{{ post.comments.length }}</div>
        <div class="comment-svg">
          <svg
            version="1.1"
            id="Capa_1"
            xmlns="http://www.w3.org/2000/svg"
            xmlns:xlink="http://www.w3.org/1999/xlink"
            x="0px"
            y="0px"
            viewBox="0 0 60 60"
            style="enable-background:new 0 0 60 60;"
            xml:space="preserve"
          >
            <path
              class="comment-svg-path"
              style="fill: white"
              d="M6,2h48c3.252,0,6,2.748,6,6v33c0,3.252-2.748,6-6,6H25.442L15.74,57.673C15.546,57.885,15.276,58,15,58
               c-0.121,0-0.243-0.022-0.361-0.067C14.254,57.784,14,57.413,14,57V47H6c-3.252,0-6-2.748-6-6L0,8C0,4.748,2.748,2,6,2z"
            />
            <g></g>
            <g></g>
            <g></g>
            <g></g>
            <g></g>
            <g></g>
            <g></g>
            <g></g>
            <g></g>
            <g></g>
            <g></g>
            <g></g>
            <g></g>
            <g></g>
            <g></g>
          </svg>
        </div>
      </div>
    </div>
    <div class="add-comment" (click)="openAddComment()">
      <div class="add-comment-svg">
        <svg
          version="1.1"
          id="Capa_1"
          xmlns="http://www.w3.org/2000/svg"
          xmlns:xlink="http://www.w3.org/1999/xlink"
          x="0px"
          y="0px"
          viewBox="0 0 60 60"
          style="enable-background:new 0 0 60 60;"
          xml:space="preserve"
        >
          <path
            style="fill: #194470;"
            d="M6,2h48c3.252,0,6,2.748,6,6v33c0,3.252-2.748,6-6,6H25.442L15.74,57.673C15.546,57.885,15.276,58,15,58
                         c-0.121,0-0.243-0.022-0.361-0.067C14.254,57.784,14,57.413,14,57V47H6c-3.252,0-6-2.748-6-6L0,8C0,4.748,2.748,2,6,2z"
          />
          <g></g>
          <g></g>
          <g></g>
          <g></g>
          <g></g>
          <g></g>
          <g></g>
          <g></g>
          <g></g>
          <g></g>
          <g></g>
          <g></g>
          <g></g>
          <g></g>
          <g></g>
        </svg>
      </div>
      <div class="add-comment-text">
        Add a comment
      </div>
    </div>
  </div>
  <div class="add-comment-container" *ngIf="addCommentOpen" [@addCommentSlide]>
    <div
      class="show-hide-comments"
      [ngClass]="{
        blueText: index % 2 === 1,
        hide: post.comments.length < 6 || neverShowMoreComments
      }"
    >
      <p (click)="seeMoreComments($event)">
        See {{ wrappedCommentsAmount }} more comments
      </p>
    </div>

    <div *ngIf="!commentsWrappable">
      <app-comments
        *ngFor="let comment of post.comments; index as i"
        [comment]="comment"
        [indexComment]="i"
        [index]="index"
        [currentPost]="post"
        [@singlePost]
      ></app-comments>
    </div>

    <div *ngIf="commentsWrappable">
      <app-comments
        *ngFor="let comment of commentsToBeShown; index as i"
        [comment]="comment"
        [indexComment]="i"
        [index]="index"
        [currentPost]="post"
        [wrappedComments]="commentsWrappable"
        [@singlePost]
      ></app-comments>
    </div>

    <!--   *ngIf="comment[i] < post['comments'].length - 2" -->

    <div class="add-comment-wrapper">
      <div class="add-comment-img-container">
        <svg
          class="author-post-img"
          *ngIf="loggedUser.imgPath === 'unset'"
          xmlns="http://www.w3.org/2000/svg"
          width="20px"
          height="20px"
          viewBox="0 0 24 24"
        >
          <g
            fill="none"
            fill-rule="evenodd"
            stroke="#1b3d5d"
            transform="translate(4 3)"
          >
            <circle cx="7.5" cy="5" r="5"></circle>
            <path d="M15 17.5a7.5 7.5 0 0 0-15 0"></path>
          </g>
        </svg>
        <img
          class="user-set-picture"
          *ngIf="loggedUser.imgPath != 'unset'"
          [src]="loggedUser.imgPath"
        />
      </div>
      <div class="add-new-comment">
        <form
          (ngSubmit)="postComment(addCommentForm, $event)"
          #addCommentForm="ngForm"
        >
          <textarea
            name="comment"
            id="newCommentTextarea"
            rows="1"
            placeholder="Add a comment..."
            (keyup)="autogrow($event)"
            required
            ngModel
          ></textarea>
          <button type="submit" [disabled]="!addCommentForm.valid">
            Post
          </button>
          <button type="button" class="cancelButton" (click)="openAddComment()">
            Cancel
          </button>
        </form>
      </div>
    </div>
  </div>
</div>
